{% load static %}
{% load i18n %}
<footer class="paypal-footer">
    <div class="footer-container">
        <div class="footer-content">
            <!-- Logo and Description -->
            <div class="footer-section footer-brand">
                <div class="footer-logo">
                    <img src="{% static 'images/icici.png' %}?v=5" alt="ICICI Bank" style="height:40px; width:auto; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));">
                </div>
                <p class="footer-description">
                    {% trans "A trusted way to pay and get paid online." %}
                </p>
                <div class="social-links">
                    <a href="#" class="social-link" aria-label="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="social-link" aria-label="Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="social-link" aria-label="LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="#" class="social-link" aria-label="YouTube">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="#" class="social-link" aria-label="Instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="footer-section">
                <h4 class="footer-title">{% trans "Quick Links" %}</h4>
                <ul class="footer-links">
                    <li><a href="{% url 'wallet:dashboard' %}">{% trans "Dashboard" %}</a></li>
                    <li><a href="{% url 'wallet:wallet_dashboard' %}">{% trans "Wallet" %}</a></li>
                    <li><a href="{% url 'transactions:transaction_history' %}">{% trans "Transaction History" %}</a></li>
                    <li><a href="/rewards/">{% trans "Rewards" %}</a></li>
                    <li><a href="{% url 'accounts:settings' %}">{% trans "Account Settings" %}</a></li>
                </ul>
            </div>

            <!-- Support -->
            <div class="footer-section">
                <h4 class="footer-title">{% trans "Support" %}</h4>
                <ul class="footer-links">
                    <li><a href="/support/help/">{% trans "Help Center" %}</a></li>
                    <li><a href="/support/contact/">{% trans "Contact Us" %}</a></li>
                    <li><a href="/support/security/">{% trans "Security Center" %}</a></li>
                    <li><a href="/support/disputes/">{% trans "Dispute Resolution" %}</a></li>
                    <li><a href="/support/accessibility/">{% trans "Accessibility" %}</a></li>
                </ul>
            </div>

            <!-- Business -->
            <div class="footer-section">
                <h4 class="footer-title">{% trans "Business" %}</h4>
                <ul class="footer-links" id="footer-business">
                    <li><a href="#business">{% trans "Business Solutions" %}</a></li>
                    <li><a href="#merchant">{% trans "Merchant Services" %}</a></li>
                    <li><a href="#api">{% trans "Developer API" %}</a></li>
                    <li><a href="#partners">{% trans "Partner Program" %}</a></li>
                    <li><a href="#enterprise">{% trans "Enterprise" %}</a></li>
                </ul>
            </div>

            <!-- Legal -->
            <div class="footer-section">
                <h4 class="footer-title">{% trans "Legal" %}</h4>
                <ul class="footer-links" id="footer-legal">
                    <li><a href="#privacy">{% trans "Privacy Policy" %}</a></li>
                    <li><a href="#terms">{% trans "Terms of Service" %}</a></li>
                    <li><a href="#cookies">{% trans "Cookie Policy" %}</a></li>
                    <li><a href="#licenses">{% trans "Open Source Licenses" %}</a></li>
                    <li><a href="#compliance">{% trans "Compliance" %}</a></li>
                </ul>
            </div>
        </div>

        <!-- Footer Bottom -->
        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <div class="footer-copyright">
                    <p>&copy; 2024 ICICI Bank. {% trans "All rights reserved." %}</p>
                </div>
                <div class="footer-legal-links">
                    <a href="#privacy">{% trans "Privacy" %}</a>
                    <span class="separator">|</span>
                    <a href="#terms">{% trans "Terms" %}</a>
                    <span class="separator">|</span>
                    <a href="#cookies">{% trans "Cookies" %}</a>
                    <span class="separator">|</span>
                    <a href="#accessibility">{% trans "Accessibility" %}</a>
                </div>
                <div class="footer-languages">
                    <select class="language-selector">
                        <option value="en">{% trans "English" %}</option>
                        <option value="es">{% trans "Español" %}</option>
                        <option value="fr">{% trans "Français" %}</option>
                        <option value="de">{% trans "Deutsch" %}</option>
                        <option value="it">{% trans "Italiano" %}</option>
                        <option value="pt">{% trans "Português" %}</option>
                        <option value="ja">{% trans "日本語" %}</option>
                        <option value="zh">{% trans "中文" %}</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
</footer>

<style>
.paypal-footer {
    background: linear-gradient(135deg, #cc5a00 0%, #ff7a00 100%);
    color: white;
    margin-top: 4rem;
    padding: 3rem 0 1rem;
}

.footer-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
}

.footer-content {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
    gap: 3rem;
    margin-bottom: 2rem;
}

.footer-section {
    display: flex;
    flex-direction: column;
}

.footer-brand {
    max-width: 300px;
}

.footer-logo .paypal-logo {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 1rem;
}

.footer-logo .pay { color: #cc5a00; }
.footer-logo .pal { color: #ff7a00; }

.footer-description {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 1.5rem;
    line-height: 1.6;
}

.social-links {
    display: flex;
    gap: 1rem;
}

.social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    color: white;
    text-decoration: none;
    transition: all 0.3s ease;
}

.social-link:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
    color: white;
}

.footer-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: white;
}

.footer-links {
    list-style: none;
    padding: 0;
    margin: 0;
}

.footer-links li {
    margin-bottom: 0.5rem;
}

.footer-links a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    transition: color 0.3s ease;
}

.footer-links a:hover {
    color: white;
    text-decoration: underline;
}

.footer-bottom {
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    padding-top: 1.5rem;
}

.footer-bottom-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
}

.footer-copyright p {
    margin: 0;
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
}

.footer-legal-links {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.footer-legal-links a {
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.3s ease;
}

.footer-legal-links a:hover {
    color: white;
}

.separator {
    color: rgba(255, 255, 255, 0.5);
}

.language-selector {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 6px;
    color: white;
    padding: 0.5rem;
    font-size: 0.9rem;
}

.language-selector option {
    background: #cc5a00;
    color: white;
}

/* Responsive Design */
@media (max-width: 768px) {
    .footer-content {
        grid-template-columns: 1fr;
        gap: 2rem;
        text-align: center;
    }
    
    .footer-bottom-content {
        flex-direction: column;
        text-align: center;
    }
    
    .social-links {
        justify-content: center;
    }
}
</style>

<script>
  (function() {
    const groups = ['footer-business', 'footer-legal'];
    groups.forEach(function(id) {
      const list = document.getElementById(id);
      if (!list) return;
      list.querySelectorAll('a').forEach(function(a) {
        a.addEventListener('click', function(e) {
          e.preventDefault();
          alert('Coming soon');
        });
      });
    });
  })();
  </script>

<!-- Global Loader -->
<div id="globalLoader" aria-hidden="true">
  <div class="gl-backdrop"></div>
  <div class="gl-spinner" role="status" aria-live="polite" aria-label="Loading"></div>
  <span class="gl-sr" aria-live="polite">Loading…</span>
  
</div>

<style>
  #globalLoader {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1049; /* Below Bootstrap modal (1050+) so modals can appear above */
    opacity: 0;
    transition: opacity 180ms ease-in-out;
  }
  #globalLoader.show { display: flex; opacity: 1; }
  #globalLoader.hiding { opacity: 0; }
  .gl-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.6);
  }
  .gl-spinner {
    position: relative;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: 4px solid rgba(255,255,255,0.35);
    border-top-color: #ffffff;
    animation: gl-spin 0.9s linear infinite;
    box-shadow: 0 0 0 1px rgba(255,255,255,0.05) inset;
  }
  @keyframes gl-spin {
    to { transform: rotate(360deg); }
  }
  .gl-sr { position: absolute; width: 1px; height: 1px; overflow: hidden; clip: rect(0 0 0 0); white-space: nowrap; }
  @media (max-width: 480px) { .gl-spinner { width: 44px; height: 44px; border-width: 3px; } }
</style>

<script>
  (function(){
    const overlay = document.getElementById('globalLoader');
    if (!overlay) return;
    let counter = 0; let hideTimer = null;
    function showLoader(){
      if (hideTimer) { clearTimeout(hideTimer); hideTimer = null; }
      if (!overlay.classList.contains('show')) {
        overlay.style.display = 'flex';
        // next tick to allow transition
        requestAnimationFrame(()=> overlay.classList.add('show'));
      }
    }
    function hideLoader(){
      if (!overlay.classList.contains('show')) return;
      overlay.classList.remove('show');
      overlay.classList.add('hiding');
      hideTimer = setTimeout(()=>{
        overlay.classList.remove('hiding');
        overlay.style.display = 'none';
        hideTimer = null;
      }, 200);
    }
    function inc(){ if (++counter === 1) showLoader(); }
    function dec(){ if (counter > 0 && --counter === 0) hideLoader(); }

    // Intercept fetch
    if (window.fetch) {
      const origFetch = window.fetch.bind(window);
      window.fetch = function(){
        inc();
        return origFetch.apply(this, arguments).then(function(res){ dec(); return res; }, function(err){ dec(); throw err; });
      };
    }

    // Intercept XHR
    (function(){
      const XHR = window.XMLHttpRequest;
      if (!XHR) return;
      const send = XHR.prototype.send;
      XHR.prototype.send = function(){
        try { this.addEventListener('loadend', dec, { once: true }); } catch(e){}
        inc();
        return send.apply(this, arguments);
      };
    })();

    // Form submissions
    document.addEventListener('submit', function(e){
      // Only show for real submissions
      if (!e.defaultPrevented) showLoader();
    }, true);

    // Link navigation (same-origin)
    document.addEventListener('click', function(e){
      const a = e.target.closest && e.target.closest('a[href]');
      if (!a) return;
      const href = a.getAttribute('href');
      if (!href || href.startsWith('#') || a.target === '_blank' || a.hasAttribute('download')) return;
      try {
        const url = new URL(href, window.location.href);
        if (url.origin === window.location.origin) {
          showLoader();
        }
      } catch(err){}
    }, true);

    // Page unload
    window.addEventListener('beforeunload', function(){ showLoader(); });
  })();
</script>
