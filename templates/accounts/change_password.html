{% load i18n %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% trans "Change Password" %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f5f7fa; }
    .pp-header { background: linear-gradient(135deg, #003087 0%, #0070ba 100%); color:#fff; }
    .pp-header .navbar-brand { color:#fff; font-weight:600; }
    .pp-card { border:none; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); }
    .pp-card .card-header { background:#fff; border-bottom:1px solid #f0f0f0; }
    .pp-title { color:#003087; font-weight:600; }
    .form-label { font-weight:600; color:#333; }
    .form-control { border:2px solid #e1e5e9; border-radius:8px; padding:0.65rem 0.9rem; }
    .form-control:focus { border-color:#0070ba; box-shadow:0 0 0 .2rem rgba(0,112,186,.15); }
    .btn-primary { background: linear-gradient(135deg, #0070ba 0%, #005ea6 100%); border:none; border-radius:8px; font-weight:600; }
    .btn-outline-secondary { border-radius:8px; }
    .help-text { font-size:.85rem; color:#6c757d; }
    .errorlist { margin:0; padding-left:1rem; color:#b02a37; }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      var toggles = document.querySelectorAll('[data-toggle="pw"]');
      toggles.forEach(function(btn){
        btn.addEventListener('click', function(){
          var target = document.getElementById(this.getAttribute('data-target'));
          if(!target) return;
          var open = target.type === 'text';
          target.type = open ? 'password' : 'text';
          this.setAttribute('aria-pressed', (!open).toString());
          var on = this.querySelector('.eye-on');
          var off = this.querySelector('.eye-off');
          if(on && off){ on.style.display = open ? 'none' : ''; off.style.display = open ? '' : 'none'; }
        });
      });
    });
  </script>
  </head>
<body>
  <nav class="navbar pp-header">
    <div class="container">
      <a class="navbar-brand" href="{% url 'accounts:security' %}"><i class="fas fa-arrow-left me-2"></i>{% trans "Change Password" %}</a>
    </div>
  </nav>

  <div class="container my-5">
    <div class="row justify-content-center">
      <div class="col-lg-6 col-md-8">
        <div class="card pp-card">
          <div class="card-header py-3">
            <h4 class="mb-0 pp-title">{% trans "Update your password" %}</h4>
          </div>
          <div class="card-body p-4">
            {% if messages %}
              {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
              {% endfor %}
            {% endif %}

            {% if form.non_field_errors %}
              <div class="alert alert-danger">{{ form.non_field_errors }}</div>
            {% endif %}

            <form method="post" novalidate>
              {% csrf_token %}

              <div class="mb-3">
                <label for="id_old_password" class="form-label">{% trans "Current password" %}</label>
                <div class="input-group">
                  <input type="password" class="form-control" id="id_old_password" name="old_password" required>
                  <button class="btn btn-outline-secondary" type="button" data-toggle="pw" data-target="id_old_password" aria-label="{% trans 'Show password' %}">
                    <svg class="eye-on" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                    <svg class="eye-off" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.94 10.94 0 0 1 12 20c-7 0-11-8-11-8a21.8 21.8 0 0 1 5.06-6.94"/><path d="M1 1l22 22"/><path d="M10.58 10.58a3 3 0 0 0 4.24 4.24"/></svg>
                  </button>
                </div>
                {% if form.old_password.errors %}<div class="text-danger small mt-1">{{ form.old_password.errors }}</div>{% endif %}
              </div>

              <div class="mb-3">
                <label for="id_new_password1" class="form-label">{% trans "New password" %}</label>
                <div class="input-group">
                  <input type="password" class="form-control" id="id_new_password1" name="new_password1" required>
                  <button class="btn btn-outline-secondary" type="button" data-toggle="pw" data-target="id_new_password1" aria-label="{% trans 'Show password' %}">
                    <svg class="eye-on" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                    <svg class="eye-off" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.94 10.94 0 0 1 12 20c-7 0-11-8-11-8a21.8 21.8 0 0 1 5.06-6.94"/><path d="M1 1l22 22"/><path d="M10.58 10.58a3 3 0 0 0 4.24 4.24"/></svg>
                  </button>
                </div>
                <div class="help-text">{{ form.new_password1.help_text|safe }}</div>
                {% if form.new_password1.errors %}<div class="text-danger small mt-1">{{ form.new_password1.errors }}</div>{% endif %}
              </div>

              <div class="mb-4">
                <label for="id_new_password2" class="form-label">{% trans "Confirm new password" %}</label>
                <div class="input-group">
                  <input type="password" class="form-control" id="id_new_password2" name="new_password2" required>
                  <button class="btn btn-outline-secondary" type="button" data-toggle="pw" data-target="id_new_password2" aria-label="{% trans 'Show password' %}">
                    <svg class="eye-on" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                    <svg class="eye-off" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.94 10.94 0 0 1 12 20c-7 0-11-8-11-8a21.8 21.8 0 0 1 5.06-6.94"/><path d="M1 1l22 22"/><path d="M10.58 10.58a3 3 0 0 0 4.24 4.24"/></svg>
                  </button>
                </div>
                {% if form.new_password2.errors %}<div class="text-danger small mt-1">{{ form.new_password2.errors }}</div>{% endif %}
              </div>

              <div class="d-flex justify-content-between">
                <a href="{% url 'accounts:security' %}" class="btn btn-outline-secondary">{% trans "Cancel" %}</a>
                <button type="submit" class="btn btn-primary">{% trans "Change Password" %}</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
